{
    "title": "REST API Extensions",
    "description": "Erweitert die WordPress REST API um netzwerk-spezifische Endpunkte für Multisite-Verwaltung. Ermöglicht Benutzerverwaltung über alle Sites hinweg.",
    "content": "# REST API Extensions\n\n## Übersicht\n\nDas REST API Extensions Modul erweitert WordPress um zusätzliche REST API Endpunkte, die speziell für WordPress Multisite-Netzwerke entwickelt wurden. Es ermöglicht die zentrale Verwaltung von Benutzerrollen über alle Sites hinweg und bietet Funktionen zum Löschen von Benutzern mit Beitragsumverteilung.\n\n## Hauptfunktionen\n\n- Benutzerrollen über alle Sites aktualisieren\n- Liste aller Sites im Netzwerk abrufen\n- Benutzer netzwerkweit löschen\n- Optionale Beitragsumverteilung beim Löschen\n- Multisite-Unterstützung\n\n## REST API Endpunkte\n\n### POST \/wp-json\/dgptm\/v1\/user-sites\n\nAktualisiert die Rolle eines Benutzers in allen Sites des Netzwerks.\n\n**Berechtigung:** `manage_sites`\n\n**Parameter:**\n- `user_id` (erforderlich): Benutzer-ID\n- `role` (erforderlich): Rollenname (z.B. \"editor\", \"subscriber\")\n\n**Beispiel:**\n```bash\ncurl -X POST https:\/\/example.com\/wp-json\/dgptm\/v1\/user-sites \\\n  -H \"Content-Type: application\/json\" \\\n  -d '{\"user_id\": 123, \"role\": \"editor\"}'\n```\n\n**Antwort:**\n```json\n{\n  \"message\": \"User roles updated successfully\"\n}\n```\n\n### GET \/wp-json\/dgptm\/v1\/sites\n\nGibt eine Liste aller Sites im Netzwerk zurück.\n\n**Berechtigung:** `manage_sites`\n\n**Antwort:**\n```json\n[\n  {\n    \"id\": 1,\n    \"domain\": \"example.com\",\n    \"path\": \"\/\"\n  },\n  {\n    \"id\": 2,\n    \"domain\": \"example.com\",\n    \"path\": \"\/subsite\/\"\n  }\n]\n```\n\n### DELETE \/wp-json\/dgptm\/v1\/delete-user\n\nLöscht einen Benutzer aus dem gesamten Netzwerk.\n\n**Berechtigung:** `manage_sites`\n\n**Parameter:**\n- `user_id` (erforderlich): ID des zu löschenden Benutzers\n- `reassign` (optional): ID des Benutzers, dem die Beiträge zugewiesen werden sollen\n\n**Sicherheit:**\n- Der aktuelle Benutzer kann sich nicht selbst löschen\n- Super-Administratoren können nicht gelöscht werden\n\n**Beispiel:**\n```bash\ncurl -X DELETE https:\/\/example.com\/wp-json\/dgptm\/v1\/delete-user \\\n  -H \"Content-Type: application\/json\" \\\n  -d '{\"user_id\": 456, \"reassign\": 1}'\n```\n\n**Antwort:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Benutzer wurde erfolgreich gelöscht. Beiträge wurden an Benutzer 1 umverteilt.\"\n}\n```\n\n## Einrichtung\n\n### Voraussetzungen\n\n1. WordPress Multisite-Installation\n2. Benutzer mit `manage_sites` Berechtigung (Super Admin)\n\n### Installation\n\nDas Modul ist automatisch nach Aktivierung funktionsbereit. Keine zusätzliche Konfiguration erforderlich.\n\n## Verwendung\n\n### Benutzerrollen aktualisieren\n\n**Use Case:** Alle Benutzerrollen in einem Netzwerk auf einmal aktualisieren\n\n```javascript\nfetch('\/wp-json\/dgptm\/v1\/user-sites', {\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application\/json',\n    'X-WP-Nonce': wpApiSettings.nonce\n  },\n  body: JSON.stringify({\n    user_id: 123,\n    role: 'contributor'\n  })\n})\n.then(response => response.json())\n.then(data => console.log(data));\n```\n\n### Sites auflisten\n\n```javascript\nfetch('\/wp-json\/dgptm\/v1\/sites', {\n  headers: {\n    'X-WP-Nonce': wpApiSettings.nonce\n  }\n})\n.then(response => response.json())\n.then(sites => {\n  sites.forEach(site => {\n    console.log(`Site ${site.id}: ${site.domain}${site.path}`);\n  });\n});\n```\n\n### Benutzer löschen mit Beitragsumverteilung\n\n```javascript\nfetch('\/wp-json\/dgptm\/v1\/delete-user', {\n  method: 'DELETE',\n  headers: {\n    'Content-Type': 'application\/json',\n    'X-WP-Nonce': wpApiSettings.nonce\n  },\n  body: JSON.stringify({\n    user_id: 456,\n    reassign: 1  \/\/ Optional\n  })\n})\n.then(response => response.json())\n.then(data => {\n  if (data.success) {\n    console.log('Benutzer gelöscht');\n  }\n});\n```\n\n## Technische Details\n\n### Berechtigungen\n\nAlle Endpunkte erfordern die Berechtigung `manage_sites`, die standardmäßig nur Super-Administratoren haben.\n\n### Multisite-Funktionen\n\nDas Modul nutzt WordPress Multisite-Funktionen:\n- `get_sites()` - Alle Sites abrufen\n- `switch_to_blog()` - Zu anderer Site wechseln\n- `restore_current_blog()` - Zur ursprünglichen Site zurück\n- `wpmu_delete_user()` - Benutzer netzwerkweit löschen\n\n### Error Handling\n\n**Fehler-Codes:**\n- `400` - Fehlende oder ungültige Parameter\n- `403` - Unzureichende Berechtigungen \/ Verbotene Aktion\n- `404` - Benutzer nicht gefunden\n- `500` - Interner Serverfehler\n\n## Tipps & Best Practices\n\n1. **Batch-Operationen:**\n   - Bei vielen Benutzern: Operationen in kleinere Batches aufteilen\n   - Rate Limiting beachten\n\n2. **Sicherheit:**\n   - Immer `reassign` Parameter verwenden, um Datenverlust zu vermeiden\n   - Vor dem Löschen Backup erstellen\n   - Prüfen Sie Berechtigungen serverseitig\n\n3. **Performance:**\n   - Bei großen Netzwerken können Operationen Zeit benötigen\n   - Timeout-Werte ggf. erhöhen\n\n## Fehlerbehebung\n\n### \"User not found on site\"\n\n**Problem:** Benutzer existiert nicht auf einer der Sites\n\n**Lösung:**\n1. Prüfen Sie, ob Benutzer auf allen Sites existiert\n2. Nutzen Sie `\/sites` Endpunkt zur Überprüfung\n3. Fügen Sie Benutzer zu fehlenden Sites hinzu\n\n### \"Insufficient permissions\"\n\n**Problem:** Benutzer hat keine `manage_sites` Berechtigung\n\n**Lösung:**\n1. Als Super-Admin einloggen\n2. Oder: Berechtigung dem Benutzer zuweisen\n\n### Timeout bei vielen Sites\n\n**Problem:** Request läuft in Timeout bei vielen Sites\n\n**Lösung:**\n```php\n\/\/ In wp-config.php\nset_time_limit(300); \/\/ 5 Minuten\n```",
    "features": [
        "Benutzerrollen netzwerkweit aktualisieren",
        "Sites-Liste abrufen",
        "Benutzer löschen mit Beitragsumverteilung",
        "Multisite-Support",
        "REST API Integration",
        "Fehlerbehandlung und Validierung"
    ],
    "keywords": [
        "rest-api",
        "multisite",
        "network",
        "users",
        "roles",
        "management",
        "sites",
        "delete-user"
    ],
    "module_id": "rest-api-extension",
    "last_updated": "2025-11-29 17:38:29"
}